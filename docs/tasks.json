[
  {
    "id": "BE-001",
    "type": "backend",
    "title": "Auth Service - Phone OTP & Single Device Binding",
    "description": "Implement FastAPI endpoints for phone-based OTP login with SMS provider integration, single active session per account, and automatic logout of previous devices. Persist device fingerprint and enforce re-verification when device changes.",
    "acceptance_criteria": "- POST /auth/request-code sends OTP via SMS sandbox\n- POST /auth/verify returns JWT tied to device_id\n- Second device login invalidates prior refresh token and session\n- Audit log entry created for every login/logout",
    "priority": "P0",
    "prd_ref": "REQ-1",
    "status": "todo"
  },
  {
    "id": "BE-002",
    "type": "backend",
    "title": "Relationship Binding & Forced Unlink API",
    "description": "Create APIs for generating 6-digit binding codes, linking exactly two users, and managing mutual or forced unbind flows. Include cooldowns, confirmation logic, and orphaned-data cleanup routines required for single-user forced release.",
    "acceptance_criteria": "- POST /relationship/bind issues unique code valid for 10 minutes\n- PUT /relationship/confirm links two accounts and returns shared relationship_id\n- DELETE /relationship handles dual-confirm and forced unbind with data purge\n- State machine prevents multiple relationships per user",
    "priority": "P0",
    "prd_ref": "REQ-1",
    "status": "todo"
  },
  {
    "id": "BE-003",
    "type": "backend",
    "title": "Permission Status Aggregator & Push Alerts",
    "description": "Build a service that ingests permission heartbeats (location, notifications, usage access, installation status) from the monitored device, stores latest state, and triggers push notifications to the watcher within 60 seconds of changes.",
    "acceptance_criteria": "- PATCH /device-status updates permission flags with timestamps\n- Redis/queue job detects changes and sends push in <60s\n- GET /relationship/{id}/status returns current permission snapshot\n- Simulated toggle-off event emits push with correct copy",
    "priority": "P0",
    "prd_ref": "REQ-2",
    "status": "todo"
  },
  {
    "id": "BE-004",
    "type": "backend",
    "title": "Heartbeat Monitor & Unknown State Escalation",
    "description": "Implement scheduled job that expects device heartbeat packets every minute during active periods and geofence-triggered updates otherwise. If no heartbeat is received for 5 minutes, mark relationship state as unknown/lost and notify watcher.",
    "acceptance_criteria": "- Heartbeat table tracks last_seen per device\n- Cron or worker transitions to UNKNOWN status after 5 minutes idle\n- Push notification issued immediately on status change\n- Metrics emitted for heartbeat latency and failure counts",
    "priority": "P0",
    "prd_ref": "REQ-6",
    "status": "todo"
  },
  {
    "id": "ALG-001",
    "type": "algorithm",
    "title": "Location Data Cleaning & Compression Pipeline",
    "description": "Design a preprocessing module that denoises incoming GPS samples (Kalman/low-pass filter), deduplicates near-identical points, and compresses tracks before persisting or emitting events so downstream logic receives stable data.",
    "acceptance_criteria": "- Input noisy track reduced to <=30% redundant points\n- Filter preserves positional accuracy within 15 meters\n- CPU usage profiled <20ms per batch on reference device\n- Unit tests cover jitter scenarios and stationary periods",
    "priority": "P0",
    "prd_ref": "REQ-6",
    "status": "todo"
  },
  {
    "id": "BE-005",
    "type": "backend",
    "title": "Real-Time Location Sync Service",
    "description": "Create FastAPI endpoints and worker to accept cleaned GPS data (from ALG-001), enforce 1-minute active sync cadence, persist tracks, and compute live distance between partners for delivery to clients and WebSocket streams.",
    "acceptance_criteria": "- POST /location accepts batch payload validated against schema\n- Distance computation returns meters/kilometers automatically\n- DB stores per-minute samples with TTL policy\n- Depends on ALG-001 output availability",
    "priority": "P0",
    "prd_ref": "REQ-3",
    "status": "todo"
  },
  {
    "id": "BE-006",
    "type": "backend",
    "title": "Geofencing Arrival/Departure Event Generator",
    "description": "Implement configurable geofence definitions (home, work, custom) per relationship, detect enter/exit events using cleaned tracks, and emit structured events for behavior feed and push notifications.",
    "acceptance_criteria": "- CRUD endpoints manage geofence polygons/circles\n- Worker detects enter/exit with <150m hysteresis\n- Events published to queue for notification service\n- Depends on BE-005 location persistence",
    "priority": "P0",
    "prd_ref": "REQ-3",
    "status": "todo"
  },
  {
    "id": "ALG-002",
    "type": "algorithm",
    "title": "Motion & Trip State Inference Engine",
    "description": "Develop accelerometer/velocity-based classifier that labels states like boarding vehicle, alighting, or general movement, and exposes API/worker interface to push state transitions to downstream notification flows.",
    "acceptance_criteria": "- Input sensor stream produces states: stationary, vehicle_on, vehicle_off, walking\n- False positive rate <10% on test dataset\n- State transitions delivered via event bus for BE-007\n- Unit tests cover acceleration edge cases",
    "priority": "P0",
    "prd_ref": "REQ-3",
    "status": "todo"
  },
  {
    "id": "BE-007",
    "type": "backend",
    "title": "Notification Orchestrator",
    "description": "Centralize dispatch of permission alerts, geofence events, motion states, and daily safety summaries. Route to push/SMS with rate limits, localized copy, and deduplication keyed per relationship.",
    "acceptance_criteria": "- Service consumes events from BE-003, BE-006, ALG-002\n- Push delivered via provider SDK with 2s p95 latency\n- Safety summary generated daily at configurable time\n- Duplicate events suppressed within 60 seconds window",
    "priority": "P0",
    "prd_ref": "REQ-3",
    "status": "todo"
  },
  {
    "id": "BE-008",
    "type": "backend",
    "title": "Device Status & Telemetry API",
    "description": "Expose endpoints to ingest and serve device telemetry (battery level ±10%, WiFi/Cell info) and uninstall detection flags. Store history for 24 hours for UI display and premium analytics.",
    "acceptance_criteria": "- PATCH /device-telemetry accepts battery/network data\n- Data validation enforces ±10% tolerance\n- GET /relationship/{id}/telemetry returns latest snapshot and history\n- Integration test shows uninstall flag flips UI state",
    "priority": "P0",
    "prd_ref": "REQ-3",
    "status": "todo"
  },
  {
    "id": "BE-009",
    "type": "backend",
    "title": "Subscription & Entitlement Service",
    "description": "Integrate App Store, Play Billing, and web payments for the dual-user plans, manage SKU pricing, receipt validation, shared entitlement activation, and downgrade logic.",
    "acceptance_criteria": "- POST /billing/receipt verifies platform signatures\n- Entitlement table enables premium modules for both partners\n- Grace period logic handles failed renewals\n- Webhook simulation activates/deactivates access correctly",
    "priority": "P1",
    "prd_ref": "REQ-4",
    "status": "todo"
  },
  {
    "id": "BE-010",
    "type": "backend",
    "title": "Audit & History Data Store",
    "description": "Create scalable storage and APIs for trajectory playback, unlock events, app usage distribution, Lookus view logs, and sensitive action timestamps with pagination and retention policies.",
    "acceptance_criteria": "- ETL jobs persist trajectories with stop durations\n- GET /audit/unlocks lists timestamps and daily counts\n- Lookus (viewer) access recorded with requester id & time\n- Data partitioned per user and deletable on unbind",
    "priority": "P1",
    "prd_ref": "REQ-4",
    "status": "todo"
  },
  {
    "id": "BE-011",
    "type": "backend",
    "title": "Emergency Alert Endpoint",
    "description": "Provide secure endpoint to trigger high-priority notifications with custom siren sounds, bypassing silent mode. Include throttling and audit logging for abuse prevention.",
    "acceptance_criteria": "- POST /emergency triggers push with priority flag\n- Server ensures alert reaches devices in <5s p95\n- Rate limit enforced (e.g., 3 per hour per relationship)\n- Alert recorded in audit log for BE-010",
    "priority": "P1",
    "prd_ref": "REQ-5",
    "status": "todo"
  },
  {
    "id": "BE-012",
    "type": "backend",
    "title": "WebSocket Channel for Live Updates",
    "description": "Implement authenticated WebSocket gateway delivering live location, permission states, and telemetry updates with topic separation per relationship and fallbacks to polling when disconnected.",
    "acceptance_criteria": "- /ws endpoint requires JWT and relationship scope\n- Messages carry trace_id for observability\n- Disconnect detection downgrades to polling after timeout\n- Load test supports 10k concurrent sockets with <1s lag",
    "priority": "P0",
    "prd_ref": "REQ-3",
    "status": "todo"
  },
  {
    "id": "CFG-001",
    "type": "config",
    "title": "Observability & Traceability Foundation",
    "description": "Instrument FastAPI services with structured logging, Trace ID propagation (OpenTelemetry), metrics for heartbeats/location latency, and dashboards/alerts for push failures or missing heartbeats.",
    "acceptance_criteria": "- All API responses include trace-id header\n- Logs ship to centralized sink with permission/motion tags\n- Grafana/Prometheus dashboard shows heartbeat health and push success\n- Alert fires when heartbeat success rate <95%",
    "priority": "P0",
    "prd_ref": "REQ-6",
    "status": "todo"
  },
  {
    "id": "CFG-002",
    "type": "config",
    "title": "Push & SMS Provider Infrastructure Setup",
    "description": "Configure notification provider credentials, SMS gateways for OTP, secret storage, and CI/CD secrets management to support BE-001, BE-003, and BE-007 flows.",
    "acceptance_criteria": "- Provider keys stored in secrets manager with rotation policy\n- Sandbox push + SMS tested from staging\n- Deployment manifests mount credentials securely\n- Depends on BE-001 and BE-007 readiness",
    "priority": "P0",
    "prd_ref": "REQ-2",
    "status": "todo"
  },
  {
    "id": "BE-013",
    "type": "backend",
    "title": "Privacy Consent & Data Purge Compliance",
    "description": "Implement APIs and storage hooks to capture explicit consent per permission, expose consent logs, and perform complete data deletion upon forced unbind per privacy rules.",
    "acceptance_criteria": "- POST /consent logs scope, platform, timestamp\n- Audit endpoint returns consent history for regulators\n- Forced unbind triggers async purge jobs verified in tests\n- User can export consent and deletion confirmation",
    "priority": "P0",
    "prd_ref": "REQ-6",
    "status": "todo"
  },
  {
    "id": "FE-001",
    "type": "frontend",
    "title": "Mobile Auth Flow - Phone OTP & Device Binding",
    "description": "Build cross-platform UI for requesting OTP, input validation, countdown timers, and handling single-device restrictions (show warning when another device is active).",
    "acceptance_criteria": "- OTP request button disabled until phone valid\n- Verification success navigates to pairing screen\n- If session exists elsewhere, UI prompts to continue with rebind\n- Error states styled per design system",
    "priority": "P0",
    "prd_ref": "REQ-1",
    "status": "todo"
  },
  {
    "id": "FE-002",
    "type": "frontend",
    "title": "Relationship Binding & Management UI",
    "description": "Implement UI for generating/displaying 6-digit code, entering partner code, showing relationship status, and forced unbind confirmation with data-loss warning modal.",
    "acceptance_criteria": "- Code modal refreshes every 60s\n- Input state enforces numeric-only six digits\n- Status widget updates instantly after backend response\n- Forced unbind flow requires double confirmation",
    "priority": "P0",
    "prd_ref": "REQ-1",
    "status": "todo"
  },
  {
    "id": "FE-003",
    "type": "frontend",
    "title": "Permission Onboarding Theater Flow",
    "description": "Create multi-step guided experience explaining why each permission is needed (location, notifications, auto-start, usage access). Include context screens, OS-specific deep links, and progress indicator.",
    "acceptance_criteria": "- Steps render contextual copy and animation per permission\n- CTA opens native settings via deep link\n- Completion state stored locally and synced to backend\n- Flow resumes at the correct step after app relaunch",
    "priority": "P0",
    "prd_ref": "REQ-2",
    "status": "todo"
  },
  {
    "id": "FE-004",
    "type": "frontend",
    "title": "Permission Status & Anti-Escape Board",
    "description": "Design dashboard for watcher showing real-time permission health, uninstall detection, and last heartbeat timestamp with color-coded alerts sourced from BE-003.",
    "acceptance_criteria": "- Status cards update via WebSocket within 60s of change\n- Offline/unknown states highlighted with warning banner\n- Tap-to-view history for last 3 changes per permission\n- Pull-to-refresh fallback hits REST endpoint",
    "priority": "P0",
    "prd_ref": "REQ-2",
    "status": "todo"
  },
  {
    "id": "FE-005",
    "type": "frontend",
    "title": "Live Map & Distance View",
    "description": "Implement Mapbox/Apple Maps view with real-time partner pin, satellite/standard toggle, automatic distance unit switching, and gradient trails for recent movement.",
    "acceptance_criteria": "- Map renders current location with <2s delay via WebSocket\n- Toggle switches map style instantly\n- Distance automatically displays meters <1km and km otherwise\n- Background refresh obeys sync frequency rules",
    "priority": "P0",
    "prd_ref": "REQ-3",
    "status": "todo"
  },
  {
    "id": "FE-006",
    "type": "frontend",
    "title": "Device Telemetry Panel",
    "description": "Create UI components for battery gauge, network label (WiFi SSID or 4G/5G), and uninstall indicator with contextual tooltips sourced from BE-008 APIs.",
    "acceptance_criteria": "- Battery gauge within ±10% of backend value\n- Network label switches icons based on type\n- Uninstall flag triggers critical alert state\n- Pull-to-refresh syncs latest telemetry",
    "priority": "P0",
    "prd_ref": "REQ-3",
    "status": "todo"
  },
  {
    "id": "FE-007",
    "type": "frontend",
    "title": "Behavior Feed & Notifications Center",
    "description": "Build chronological feed combining geofence events, motion states, safety summaries, and permission alerts with filtering and deep links to map view.",
    "acceptance_criteria": "- Feed renders grouped events with icons per type\n- User can filter by event category\n- Tapping event navigates to detail (map or audit screen)\n- New events pushed in real-time without app relaunch",
    "priority": "P0",
    "prd_ref": "REQ-3",
    "status": "todo"
  },
  {
    "id": "FE-008",
    "type": "frontend",
    "title": "Subscription Purchase & Entitlement UI",
    "description": "Implement pricing screen for monthly/quarterly/annual plans, integrate native purchase flows, display entitlement status to both partners, and handle grace periods.",
    "acceptance_criteria": "- Prices localized per platform\n- Purchase success updates entitlement badge without restart\n- Failed renewal shows banner with retry CTA\n- Depends on BE-009 endpoints",
    "priority": "P1",
    "prd_ref": "REQ-4",
    "status": "todo"
  },
  {
    "id": "FE-009",
    "type": "frontend",
    "title": "Audit & Playback Experience",
    "description": "Create premium screens for trajectory playback (timeline scrubber, speed graph), unlock logs, app usage charts, Lookus access list, and sensitive action timeline sourced from BE-010.",
    "acceptance_criteria": "- Map playback animates full-day track with pause/resume\n- Unlock log lists timestamps with daily totals\n- Usage chart renders stacked bars for Android data\n- Sensitive actions timeline shows close-locate/force-exit entries",
    "priority": "P1",
    "prd_ref": "REQ-4",
    "status": "todo"
  },
  {
    "id": "FE-010",
    "type": "frontend",
    "title": "Emergency Alert Trigger UI",
    "description": "Provide prominent button with confirmation sheet to fire emergency alerts, showing countdown, success state, and history referencing BE-011.",
    "acceptance_criteria": "- Button requires slide/confirm to avoid accidental taps\n- Successful trigger shows status screen with trace id\n- Rate limit errors surfaced with helpful copy\n- History list displays last five alerts",
    "priority": "P1",
    "prd_ref": "REQ-5",
    "status": "todo"
  }
]